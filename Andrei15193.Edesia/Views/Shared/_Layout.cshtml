@using System.Threading;
@using Andrei15193.Edesia.Resources;
<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>@ApplicationControllerStrings.ApplicationName - @ViewBag.Title</title>
	@Styles.Render("~/Content/css")
	@Styles.Render("~/Content/metro-ui/css")
	@Scripts.Render("~/bundles/modernizr")

	<script>
		var shoppingCartTotalPriceElement;
		var shoppingCartCountElement;

		function toFixed(number, fractionDifits)
		{
			return number.toFixed(2).replace(".", "@Thread.CurrentThread.CurrentUICulture.NumberFormat.NumberDecimalSeparator");
		}

		function updateShoppingCartNav()
		{
			$.getJSON("@Url.Action("DefaultJson", "ShoppingCart")")
			 .success(function (shoppingCart)
			 {
			 	shoppingCartTotalPriceElement.innerHTML = toFixed(parseFloat(shoppingCart.TotalPrice), 2);

			 	if (parseInt(shoppingCart.Count) == 1)
			 		shoppingCartCountElement.innerHTML = shoppingCart.Count + " " + "@ShoppingCartControllerStrings.ProductLabel_DisplayName";
			 	else
			 		shoppingCartCountElement.innerHTML = shoppingCart.Count + " " + "@ShoppingCartControllerStrings.ProductsLabel_DisplayName";
			 });
		}

		function addToCart(product)
		{
			$.ajax("@Url.Action("Add", "ShoppingCart")?product=" + product)
			 .success(function ()
			 {
			 	updateShoppingCartNav();
			 });
		}
	</script>
</head>
<body lang="ro" class="metro" style="margin: 0; padding: 0; height: 100%;">
	<div style="position: relative; margin: 0; padding: 0; min-height: 100%;">
		<div class="body-content" style="padding-top: 50px; padding-bottom: 50px;">
			@Html.Action("NavigationBar", "User")
			@RenderBody()
		</div>
		<div class="text-center" style="position: absolute; bottom: 0; left: 0; height: 50px; width: 100%;">
			<p style="font-size: 9pt;">
				@ApplicationControllerStrings.FooterText<br />
				<a href="@ApplicationControllerStrings.FooterUrl" target="_blank">@ApplicationControllerStrings.FooterUrlText</a>
			</p>
		</div>

		@Scripts.Render("~/bundles/jquery")
		@Scripts.Render("~/bundles/metro-ui")
		@RenderSection("scripts", required: false)
		<script>
			shoppingCartTotalPriceElement = document.getElementById("@HtmlElementId.ShoppingCartTotalPrice");
			shoppingCartCountElement = document.getElementById("@HtmlElementId.ShoppingCartCount");

			updateShoppingCartNav();
		</script>
	</div>
</body>
</html>